<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>React Game App</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.development.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.development.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/7.20.12/babel.min.js"></script>
</head>
<body>
  <div id="root"></div>
  <script type="text/babel">
    const { useState, useEffect } = React;
    const { createRoot } = ReactDOM;

    const App = () => {
      const [userData, setUserData] = useState(null);
      const [points, setPoints] = useState(0);
      const [level, setLevel] = useState(1);
      const [targetNumber, setTargetNumber] = useState(generateRandomNumber());
      const [userGuess, setUserGuess] = useState('');
      const [message, setMessage] = useState('');

      const getUserIdFromUrl = () => {
        const params = new URLSearchParams(window.location.search);
        return params.get('user_id');
      };

      const generateRandomNumber = () => Math.floor(Math.random() * 10) + 1;

      const handleVictory = () => {
        setPoints((prevPoints) => prevPoints + 10);
        setLevel((prevLevel) => prevLevel + 1);
        setMessage('Поздравляем! Вы угадали!');
        setTargetNumber(generateRandomNumber());
      };

      const handleDefeat = () => {
        setPoints((prevPoints) => Math.max(prevPoints - 5, 0));
        setMessage('Неверно! Попробуйте снова.');
      };

      const handleGuess = () => {
        const guess = parseInt(userGuess, 10);
        if (guess === targetNumber) {
          handleVictory();
        } else {
          handleDefeat();
        }
        setUserGuess('');
      };

      useEffect(() => {
        const userId = getUserIdFromUrl();
        if (!userId) {
          setUserData({ id: 'guest', username: 'Гость' });
        } else {
          // Здесь можно загрузить данные пользователя
          setUserData({ id: userId, username: `Пользователь ${userId}` });
        }
      }, []);

      if (!userData) return <p>Загрузка...</p>;

      return (
        <div className="App" style={{ textAlign: 'center', padding: '20px' }}>
          <h1>Игра: Угадай число</h1>
          <p>ID: {userData.id}</p>
          <p>Имя пользователя: {userData.username}</p>
          <p>Очки: {points}</p>
          <p>Уровень: {level}</p>

          <div style={{ marginTop: '20px' }}>
            <input
              type="number"
              value={userGuess}
              onChange={(e) => setUserGuess(e.target.value)}
              placeholder="Введите число (1-10)"
            />
            <button onClick={handleGuess} style={{ marginLeft: '10px' }}>
              Угадать
            </button>
          </div>

          <p style={{ marginTop: '20px', fontWeight: 'bold' }}>{message}</p>
        </div>
      );
    };

    const root = createRoot(document.getElementById('root'));
    root.render(<App />);
  </script>
</body>
</html>
