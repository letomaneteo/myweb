<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Тестовое приложение</title>
    <script>
        // Функция для получения данных пользователя из сервера
        async function fetchUserData(userId) {
            try {
                const response = await fetch(`https://4f52-213-109-225-82.ngrok-free.app/get_data/${userId}`);
                if (response.ok) {
                    const data = await response.json();
                    displayUserData(data);
                } else {
                    console.error('Не удалось получить данные:', response.status);
                }
            } catch (error) {
                console.error('Ошибка при получении данных:', error);
            }
        }

        // Функция для отображения данных пользователя
        function displayUserData(data) {
            const userDataContainer = document.getElementById('userData');
            userDataContainer.innerHTML = `
                <p>ID: ${data.id}</p>
                <p>Имя: ${data.username}</p>
                <p>Очки: ${data.points}</p>
            `;
        }

        // Функция для обновления очков пользователя
        async function updatePoints() {
            const userId = document.getElementById('userId').value;
            const newPoints = parseInt(document.getElementById('newPoints').value, 10);
            const requestData = {
                id: userId,
                points: newPoints
            };

            try {
                const response = await fetch('https://4f52-213-109-225-82.ngrok-free.app/send_data', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(requestData)
                });

                if (response.ok) {
                    const responseData = await response.json();
                    console.log('Ответ от сервера:', responseData);
                    alert('Очки обновлены успешно!');
                    fetchUserData(userId); // Обновляем данные пользователя после изменения очков
                } else {
                    const errorData = await response.text();
                    console.error('Ошибка при запросе:', errorData);
                    alert('Ошибка при обновлении очков.');
                }
            } catch (error) {
                console.error('Ошибка выполнения запроса:', error);
                alert('Произошла ошибка при обновлении данных.');
            }
        }
    </script>
</head>
<body>
    <h1>Данные пользователя</h1>
    <div id="userData">
        <!-- Здесь будут отображаться данные пользователя -->
    </div>

    <h2>Изменить очки</h2>
    <label for="userId">ID пользователя:</label>
    <input type="text" id="userId" placeholder="Введите ID пользователя">
    <br>
    <label for="newPoints">Новые очки:</label>
    <input type="number" id="newPoints" placeholder="Введите новое значение очков">
    <br>
    <button onclick="updatePoints()">Обновить очки</button>

    <script>
        // Предположим, что ID пользователя 123
        const userId = 123;
        fetchUserData(userId); // Загружаем данные при загрузке страницы
    </script>
</body>
</html>
